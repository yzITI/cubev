<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>test</title>
  <script>
    let scriptEls = []
    async function test () {
      for (let i = 1; i <= 10; i++) {
        const scriptEl = document.createElement('script')
        scriptEl.setAttribute('type', 'module')
        // send ok in the module script to ensure sequential evaluation of multiple proxy.eval() calls
        const done = new Promise((resolve) => {
          window.__next__ = resolve
        })
        scriptEl.innerHTML = `console.log(${i});\nwindow.__next__()`
        document.head.appendChild(scriptEl)
        scriptEl.onerror = console.error
        scriptEls.push(scriptEl)
        await done
      }
      window.__next__ = undefined
    }
    test()
  </script>
</head>
<body>
</body>
</html>